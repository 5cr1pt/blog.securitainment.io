<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    
      WINDOWS CMD 命令行下载文件的几种方法
    
  </title>

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="WINDOWS CMD 命令行下载文件的几种方法" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="certutil $ certutil.exe -urlcache -split -f http://7-zip.org/a/7z1604-x64.exe 7zip.exe" />
<meta property="og:description" content="certutil $ certutil.exe -urlcache -split -f http://7-zip.org/a/7z1604-x64.exe 7zip.exe" />
<link rel="canonical" href="https://blog.securitainment.io/windows/cmd/pentest/2020/10/01/Download-Files-In-Windows-CMD.html" />
<meta property="og:url" content="https://blog.securitainment.io/windows/cmd/pentest/2020/10/01/Download-Files-In-Windows-CMD.html" />
<meta property="og:site_name" content="Securitainment.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-01T23:44:00+08:00" />
<script type="application/ld+json">
{"url":"https://blog.securitainment.io/windows/cmd/pentest/2020/10/01/Download-Files-In-Windows-CMD.html","dateModified":"2020-10-01T23:44:00+08:00","datePublished":"2020-10-01T23:44:00+08:00","headline":"WINDOWS CMD 命令行下载文件的几种方法","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.securitainment.io/windows/cmd/pentest/2020/10/01/Download-Files-In-Windows-CMD.html"},"description":"certutil $ certutil.exe -urlcache -split -f http://7-zip.org/a/7z1604-x64.exe 7zip.exe","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="https://blog.securitainment.io/feed.xml" title="Securitainment.io" />

  <link rel="shortcut icon" type="image/x-icon" href="/" />
  <link rel="stylesheet" href="https://blog.securitainment.io/assets/css/main.css" />
</head>
<body>
    <main class="page-content" aria-label="Content">
        <div class="wrapper">
            <a href="https://blog.securitainment.io"></a>
<h1>WINDOWS CMD 命令行下载文件的几种方法</h1>
<h2 id="certutil">certutil</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>certutil.exe <span class="nt">-urlcache</span> <span class="nt">-split</span> <span class="nt">-f</span> http://7-zip.org/a/7z1604-x64.exe 7zip.exe
</code></pre></div></div>

<h2 id="bitsdmin">bitsdmin</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bitsadmin /transfer taskname http://7-zip.org/a/7z1604-x64.exe c:<span class="se">\t</span>emp<span class="se">\7</span>zip.exe
</code></pre></div></div>

<h3 id="copy-file">Copy file</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ bitsadmin /create taskname
$ bitsadmin /addfile taskname c:\temp\7zip.exe c:\7zip.exe
$ bitsadmin /resume taskname
$ bitsadmin /complete taskname
</code></pre></div></div>

<h2 id="vbs">vbs</h2>
<p>Windows 10 未测试成功。</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 用echo写入</span>
On Error Resume Next
Dim iRemote,iLocal
iLocal <span class="o">=</span> LCase<span class="o">(</span>WScript.Arguments<span class="o">(</span>1<span class="o">))</span>
iRemote <span class="o">=</span> LCase<span class="o">(</span>WScript.Arguments<span class="o">(</span>0<span class="o">))</span>
Set xPost <span class="o">=</span> createObject<span class="o">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="o">)</span>
xPost.Open <span class="s2">"GET"</span>,iRemote,0
xPost.Send<span class="o">()</span>
Set sGet <span class="o">=</span> createObject<span class="o">(</span><span class="s2">"ADODB.Stream"</span><span class="o">)</span>
sGet.Mode <span class="o">=</span> 3
sGet.Type <span class="o">=</span> 1
sGet.Open<span class="o">()</span>
sGet.Write<span class="o">(</span>xPost.responseBody<span class="o">)</span>
sGet.SaveToFile iLocal,2
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cscript ff.vbs http://7-zip.org/a/7z1604-x64.exe 7zip.exe
</code></pre></div></div>

<h2 id="powershell">powershell</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>powershell <span class="o">(</span>new-object System.Net.WebClient<span class="o">)</span>.DownloadFile<span class="o">(</span> <span class="s1">'http://7-zip.org/a/7z1604-x64.exe'</span>,<span class="s1">'c:\temp\7zip.exe'</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="ftp">ftp</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span>open 8.8.8.8 <span class="o">&gt;</span> a.txt &amp; <span class="nb">echo </span>get fuck.exe&gt;&gt;a.txt &amp; <span class="nb">echo </span>bye&gt;&gt;a.txt
<span class="nv">$ </span>ftp <span class="nt">-A</span> <span class="nt">-s</span>:a.txt
</code></pre></div></div>
<blockquote>

  <p><a href="https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/">Bitsadmin.exe</a></p>

  <p><a href="https://www.hackingarticles.in/windows-for-pentester-bitsadmin/">Windows for Pentester: BITSAdmin</a></p>

  <p><a href="https://www.jianshu.com/p/afb1e7b8acaf">cmd 环境下载文件的几种方法</a></p>
</blockquote>
<br/><p>Comments:</p>

<script src="https://utteranc.es/client.js"
        repo="5cr1pt/commnets.blog.securitainment.io"
        issue-term="url"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>
<div><a href='https://blog.securitainment.io' style='text-align:center'>HOME</a>
</div>
<div style="display:none">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-137221448-1', 'auto');
    ga('send', 'pageview');

  </script>
</div>

        </div>
    </main>

    
    </body>
</html>
