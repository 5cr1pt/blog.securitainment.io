<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    
      Kali Linux 渗透测试(OSCP)笔记 0x02
    
  </title>

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Kali Linux 渗透测试(OSCP)笔记 0x02" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Bash 环境 环境变量 使用 echo 和 $ 后面跟环境变量名来显示相应的环境变量： $ echo $PATH /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" />
<meta property="og:description" content="Bash 环境 环境变量 使用 echo 和 $ 后面跟环境变量名来显示相应的环境变量： $ echo $PATH /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" />
<link rel="canonical" href="https://blog.securitainment.io/pentest/kali/linux/2020/10/10/pentesting-with-kali-0x02.html" />
<meta property="og:url" content="https://blog.securitainment.io/pentest/kali/linux/2020/10/10/pentesting-with-kali-0x02.html" />
<meta property="og:site_name" content="Securitainment.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-10T14:49:39+08:00" />
<script type="application/ld+json">
{"url":"https://blog.securitainment.io/pentest/kali/linux/2020/10/10/pentesting-with-kali-0x02.html","dateModified":"2020-10-10T14:49:39+08:00","datePublished":"2020-10-10T14:49:39+08:00","headline":"Kali Linux 渗透测试(OSCP)笔记 0x02","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.securitainment.io/pentest/kali/linux/2020/10/10/pentesting-with-kali-0x02.html"},"description":"Bash 环境 环境变量 使用 echo 和 $ 后面跟环境变量名来显示相应的环境变量： $ echo $PATH /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="https://blog.securitainment.io/feed.xml" title="Securitainment.io" />

  <link rel="shortcut icon" type="image/x-icon" href="/" />
  <link rel="stylesheet" href="https://blog.securitainment.io/assets/css/main.css" />
</head>
<body>
    <main class="page-content" aria-label="Content">
        <div class="wrapper">
            <a href="https://blog.securitainment.io"></a>
<h1>Kali Linux 渗透测试(OSCP)笔记 0x02</h1>
<ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#bash-环境">Bash 环境</a>
<ul>
<li class="toc-entry toc-h3"><a href="#环境变量">环境变量</a></li>
<li class="toc-entry toc-h3"><a href="#tab-自动补全">Tab 自动补全</a></li>
<li class="toc-entry toc-h3"><a href="#bash-历史记录">Bash 历史记录</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#管道和重定向">管道和重定向</a>
<ul>
<li class="toc-entry toc-h3"><a href="#重定向到新文件">重定向到新文件</a></li>
<li class="toc-entry toc-h3"><a href="#重定向到已存在的文件">重定向到已存在的文件</a></li>
<li class="toc-entry toc-h3"><a href="#将文件内容重定向出来">将文件内容重定向出来</a></li>
<li class="toc-entry toc-h3"><a href="#重定向标准错误流">重定向标准错误流</a></li>
<li class="toc-entry toc-h3"><a href="#管道符">管道符</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#文字搜索和相关操作">文字搜索和相关操作</a>
<ul>
<li class="toc-entry toc-h3"><a href="#grep">grep</a></li>
<li class="toc-entry toc-h3"><a href="#sed">sed</a></li>
<li class="toc-entry toc-h3"><a href="#cut">cut</a></li>
<li class="toc-entry toc-h3"><a href="#awk">awk</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#在命令行编辑文件">在命令行编辑文件</a>
<ul>
<li class="toc-entry toc-h3"><a href="#nano">nano</a></li>
<li class="toc-entry toc-h3"><a href="#vi">vi</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#文件对比">文件对比</a>
<ul>
<li class="toc-entry toc-h3"><a href="#comm">comm</a></li>
<li class="toc-entry toc-h3"><a href="#diff">diff</a></li>
<li class="toc-entry toc-h3"><a href="#vimdiff">vimdiff</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#管理进程">管理进程</a>
<ul>
<li class="toc-entry toc-h3"><a href="#后台进程bg">后台进程（bg）</a></li>
<li class="toc-entry toc-h3"><a href="#任务管理jobs-和-fg-命令">任务管理：jobs 和 fg 命令</a></li>
<li class="toc-entry toc-h3"><a href="#任务管理ps-和-kill">任务管理：ps 和 kill</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#文件和命令监控">文件和命令监控</a>
<ul>
<li class="toc-entry toc-h3"><a href="#tail">tail</a></li>
<li class="toc-entry toc-h3"><a href="#watch">watch</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#下载文件">下载文件</a>
<ul>
<li class="toc-entry toc-h3"><a href="#wget">wget</a></li>
<li class="toc-entry toc-h3"><a href="#curl">curl</a></li>
<li class="toc-entry toc-h3"><a href="#axel">axel</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#自定义-bash-环境">自定义 Bash 环境</a>
<ul>
<li class="toc-entry toc-h3"><a href="#定制-bash-历史记录">定制 Bash 历史记录</a></li>
<li class="toc-entry toc-h3"><a href="#别名alias">别名（Alias）</a></li>
<li class="toc-entry toc-h3"><a href="#持久化-bash-配置">持久化 Bash 配置</a></li>
</ul>
</li>
</ul><h2 id="bash-环境">
<a class="anchor" href="#bash-%E7%8E%AF%E5%A2%83" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bash 环境</h2>
<h3 id="环境变量">
<a class="anchor" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>环境变量</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">echo</code> 和 <code class="language-plaintext highlighter-rouge">$</code> 后面跟环境变量名来显示相应的环境变量：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$PATH</span>
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</code></pre></div></div>

<p>通过 <code class="language-plaintext highlighter-rouge">export</code> 命令来定义环境变量，假如需要扫描一个IP但是不想每次输入IP地址，可以定义一个IP变量：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">b</span><span class="o">=</span>192.168.1.10
<span class="nv">$ </span>ping <span class="nt">-c</span> 2 <span class="nv">$b</span>
PING 192.168.1.10 <span class="o">(</span>192.168.1.10<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 192.168.1.10: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>3.50 ms
64 bytes from 192.168.1.10: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.973 ms

<span class="nt">---</span> 192.168.1.10 ping statistics <span class="nt">---</span>
2 packets transmitted, 2 received, 0% packet loss, <span class="nb">time </span>10ms
rtt min/avg/max/mdev <span class="o">=</span> 0.973/2.237/3.501/1.264 ms
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">export</code> 命令定义的变量名在当前 Bash 实例下的所有子进程中都可用。如新打开一个 shell ，查看 <code class="language-plaintext highlighter-rouge">$b</code> 变量：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ $$</span>
bash: 4433
<span class="nv">$ </span>bash

<span class="nv">$ $$</span>
bash: 5132
<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$b</span>
192.168.1.10
</code></pre></div></div>

<p>使用 <code class="language-plaintext highlighter-rouge">env</code> 命令查看所有环境变量：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">env
</span><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
...
<span class="nv">PWD</span><span class="o">=</span>/home/kali
<span class="nv">XDG_SESSION_DESKTOP</span><span class="o">=</span>lightdm-xsession
<span class="nv">LOGNAME</span><span class="o">=</span>kali
<span class="nv">XDG_SESSION_TYPE</span><span class="o">=</span>x11
<span class="nv">XAUTHORITY</span><span class="o">=</span>/home/kali/.Xauthority
<span class="nv">XDG_GREETER_DATA_DIR</span><span class="o">=</span>/var/lib/lightdm/data/kali
<span class="nv">HOME</span><span class="o">=</span>/home/kali
...
<span class="nv">TERM</span><span class="o">=</span>xterm-256color
<span class="nv">USER</span><span class="o">=</span>kali
...
</code></pre></div></div>

<h3 id="tab-自动补全">
<a class="anchor" href="#tab-%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tab 自动补全</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">[Tab]</code> 键自动补全当前输入：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls </span>D[TAB]
Desktop/   Documents/ Downloads/
<span class="nv">$ </span><span class="nb">ls </span>De[TAB]sktop/

</code></pre></div></div>

<h3 id="bash-历史记录">
<a class="anchor" href="#bash-%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bash 历史记录</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">history</code> 命令查看 bash 历史记录：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">history
</span>1   <span class="nb">cat</span> /etc/lsb-release
2   clear
3   <span class="nb">history</span>
</code></pre></div></div>

<p>使用 <code class="language-plaintext highlighter-rouge">!</code> 后面跟数字来执行指定的历史命令：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="o">!</span>1    <span class="c"># 执行编号为 1 的历史命令，即 cat /etc/lsb-release</span>
<span class="nb">cat</span> /etc/lsb-release
<span class="nv">DISTRIB_ID</span><span class="o">=</span>Kali
<span class="nv">DISTRIB_RELEASE</span><span class="o">=</span>kali-rolling
<span class="nv">DISTRIB_CODENAME</span><span class="o">=</span>kali-rolling
<span class="nv">DISTRIB_DESCRIPTION</span><span class="o">=</span><span class="s2">"Kali GNU/Linux Rolling"</span>
</code></pre></div></div>

<p>使用 <code class="language-plaintext highlighter-rouge">!!</code> 执行上一个历史命令：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>systemctl restart apache2

<span class="nv">$ </span><span class="o">!!</span>
<span class="nb">sudo </span>systemctl restart apache2

</code></pre></div></div>

<p>Bash 命令历史记录默认保存在 <code class="language-plaintext highlighter-rouge">.bash_history</code> 中，<code class="language-plaintext highlighter-rouge">HISTSIZE</code> 和 <code class="language-plaintext highlighter-rouge">HISTFILESIZE</code> 环境变量可以调整当前会话记录历史记录条数和保存在 <code class="language-plaintext highlighter-rouge">.bash_history</code> 中的历史命令条数，通过修改 <code class="language-plaintext highlighter-rouge">.bashrc</code> Bash 配置文件来修改。</p>

<p>使用方向键上下来切换上一条或下一条历史记录。使用 <code class="language-plaintext highlighter-rouge">Ctrl+R</code> 命令进入 <em>reverse-i-search</em> 模式，来搜索指定开头的历史记录，然后通过回车键 <code class="language-plaintext highlighter-rouge">[Return]</code> 执行，如：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls
</span>Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos
<span class="nv">$ </span><span class="o">[</span>CTRL-R]l
<span class="o">(</span>reverse-i-search<span class="o">)</span><span class="sb">`</span>l<span class="s1">': ls

</span></code></pre></div></div>

<h2 id="管道和重定向">
<a class="anchor" href="#%E7%AE%A1%E9%81%93%E5%92%8C%E9%87%8D%E5%AE%9A%E5%90%91" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://developer.ibm.com/zh/technologies/linux/tutorials/l-lpic1-103-4/">管道和重定向</a>
</h2>
<p>每个从命令行运行的命令，都存在三个连接到该命令的数据流，用来和外部环境通讯：
|Stream Name|描述|
|–|–|
|STDIN|标准输入流|
|STDOUT|标准输出流|
|STDERR|标准错误流|</p>

<p>使用管道符 <code class="language-plaintext highlighter-rouge">|</code> 和重定向符 <code class="language-plaintext highlighter-rouge">&lt; 和 &gt;</code> 连接不同程序和文件流。</p>

<h3 id="重定向到新文件">
<a class="anchor" href="#%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E6%96%B0%E6%96%87%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>重定向到新文件</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">&gt;</code> 操作符，将标准输出重定向到文件：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"test"</span>
<span class="nb">test</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"test"</span> <span class="o">&gt;</span> redirection_test.txt

<span class="nv">$ </span><span class="nb">ls
</span>redirection_test.txt
<span class="nv">$ </span><span class="nb">cat </span>redirection_test.txt
<span class="nb">test</span>
</code></pre></div></div>

<h3 id="重定向到已存在的文件">
<a class="anchor" href="#%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E5%B7%B2%E5%AD%98%E5%9C%A8%E7%9A%84%E6%96%87%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>重定向到已存在的文件</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">&gt;&gt;</code> 将标准输出添加到已存在的文件：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"hello world"</span> <span class="o">&gt;&gt;</span> redirection_test.txt

<span class="nv">$ </span><span class="nb">cat </span>redirection_test.txt
<span class="nb">test
</span>hello world
</code></pre></div></div>

<h3 id="将文件内容重定向出来">
<a class="anchor" href="#%E5%B0%86%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E9%87%8D%E5%AE%9A%E5%90%91%E5%87%BA%E6%9D%A5" aria-hidden="true"><span class="octicon octicon-link"></span></a>将文件内容重定向出来</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">&lt;</code> 将文件内容重定向到前面输入的命令，如将 <code class="language-plaintext highlighter-rouge">redirection_test.txt</code> 文件中的内容重定向到 <code class="language-plaintext highlighter-rouge">wc</code> 命令，计算文件中字符数：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>redirection_test.txt
<span class="nb">test</span>
<span class="nv">$ </span><span class="nb">wc</span> <span class="nt">-m</span> &lt; redirection_test.txt
5
</code></pre></div></div>

<h3 id="重定向标准错误流">
<a class="anchor" href="#%E9%87%8D%E5%AE%9A%E5%90%91%E6%A0%87%E5%87%86%E9%94%99%E8%AF%AF%E6%B5%81" aria-hidden="true"><span class="octicon octicon-link"></span></a>重定向标准错误流</h3>
<p>根据 <strong>POSIX</strong> 标准，<em>STDIN, STDOUT, STDERR</em> 分别用 <em>0, 1, 2</em> 表示，这些数字可以用来从命令行操作相关的数据流，下面例子通过标准错误流来展示这些数字的作用：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> <span class="nb">.</span>
Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos
<span class="nv">$ </span><span class="nb">ls</span> ./text
<span class="nb">ls</span>: cannot access <span class="s1">'./text'</span>: No such file or directory
<span class="nv">$ </span><span class="nb">ls</span> ./test 2&gt;error.txt

<span class="nv">$ </span><span class="nb">cat </span>error.txt
<span class="nb">ls</span>: cannot access <span class="s1">'./text'</span>: No such file or directory
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">error.txt</code> 中包括了错误信息（由 <em>STDERR</em> 生成），通过 <code class="language-plaintext highlighter-rouge">&gt;</code> 操作符将错误信息重定向到了 <code class="language-plaintext highlighter-rouge">error.txt</code> 文件中（2=STDERR）。</p>

<h3 id="管道符">
<a class="anchor" href="#%E7%AE%A1%E9%81%93%E7%AC%A6" aria-hidden="true"><span class="octicon octicon-link"></span></a>管道符</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">wc</code> 命令，来展示 <code class="language-plaintext highlighter-rouge">|</code> 管道符：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>error.txt
<span class="nb">ls</span>: cannot access <span class="s1">'./text'</span>: No such file or directory
<span class="nv">$ </span><span class="nb">cat </span>error.txt | <span class="nb">wc</span> <span class="nt">-m</span>
54
<span class="nv">$ </span><span class="nb">cat </span>error.txt | <span class="nb">wc</span> <span class="nt">-m</span> <span class="o">&gt;</span> count.txt

<span class="nv">$ </span><span class="nb">cat </span>count.txt
54
</code></pre></div></div>

<p>上面例子中，使用 <code class="language-plaintext highlighter-rouge">|</code> 管道符将 <code class="language-plaintext highlighter-rouge">cat error.txt</code> 命令的输出重定向到了 <code class="language-plaintext highlighter-rouge">wc -m</code> 命令的输入中。</p>

<h2 id="文字搜索和相关操作">
<a class="anchor" href="#%E6%96%87%E5%AD%97%E6%90%9C%E7%B4%A2%E5%92%8C%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>文字搜索和相关操作</h2>
<p>这部分主要熟悉 <code class="language-plaintext highlighter-rouge">grep, sed, cut, awk</code> 命令。</p>

<h3 id="grep">
<a class="anchor" href="#grep" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://linux.die.net/man/1/grep">grep</a>
</h3>
<p><code class="language-plaintext highlighter-rouge">grep</code> 命令从当前出现的字符中通过给定的表达式搜索结果，并将包含结果的行输出到标准输出（通常是当前终端）。通常配合 <code class="language-plaintext highlighter-rouge">-r</code> (强调搜索子目录，同 <code class="language-plaintext highlighter-rouge">-d recurse</code>) 和 <code class="language-plaintext highlighter-rouge">-i</code> （忽略大小写）：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> /usr/bin | <span class="nb">grep </span>zip
lrwxrwxrwx.  1 root root          5 May 10  2019 bunzip2 -&gt; bzip2
lrwxrwxrwx.  1 root root          5 May 10  2019 bzcat -&gt; bzip2
<span class="nt">-rwxr-xr-x</span><span class="nb">.</span>  1 root root      38472 May 10  2019 bzip2
<span class="nt">-rwxr-xr-x</span><span class="nb">.</span>  1 root root      17560 May 10  2019 bzip2recover
...
</code></pre></div></div>

<h3 id="sed">
<a class="anchor" href="#sed" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://www.gnu.org/software/sed/manual/sed.html">sed</a>
</h3>
<p><strong>sed</strong> 是一个功能强大的流编辑器，也很复杂。一个简单的例子：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"I need to try hard"</span> | <span class="nb">sed</span> <span class="s1">'s/hard/harder/'</span>
I need to try harder
</code></pre></div></div>

<p>这个例子中，通过 <code class="language-plaintext highlighter-rouge">sed</code> 命令将 “I need to try hard” 字符串中的 <em>hard</em> 提换成了 <em>harder</em>，然后输出。</p>

<h3 id="cut">
<a class="anchor" href="#cut" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://linux.die.net/man/1/cut">cut</a>
</h3>
<p><code class="language-plaintext highlighter-rouge">cut</code> 命令是一个简单顺手的命令，用来将字符从字符串中提取出来并输出。常用的选项是 <code class="language-plaintext highlighter-rouge">-f</code>（字段编号） 和 <code class="language-plaintext highlighter-rouge">-d</code>（分隔符）：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"I hack binaries,web apps,mobile apps, and just about anything else"</span> | <span class="nb">cut</span> <span class="nt">-f</span> 2 <span class="nt">-d</span> <span class="s2">","</span>
web apps
</code></pre></div></div>

<p>从 <code class="language-plaintext highlighter-rouge">/etc/passwd</code> 中提取所有用户名：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">":"</span> <span class="nt">-f</span> 1 /etc/passwd
root
daemon
bin
sys
...
</code></pre></div></div>

<h3 id="awk">
<a class="anchor" href="#awk" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://www.gnu.org/software/gawk/manual/gawk.html">awk</a>
</h3>
<p><code class="language-plaintext highlighter-rouge">awk</code> 是一种程序设计语言，应用于各种计算和数据处理任务，很强大也很复杂。一个常用的操作选项是 <code class="language-plaintext highlighter-rouge">-F</code> 选项（分割字段）和 <code class="language-plaintext highlighter-rouge">print</code> 命令（输出结果）：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"hello::there::friend"</span> | <span class="nb">awk</span> <span class="nt">-F</span> <span class="s2">"::"</span> <span class="s1">'{print $1, $3}'</span>
hello friend
</code></pre></div></div>

<h2 id="在命令行编辑文件">
<a class="anchor" href="#%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%BC%96%E8%BE%91%E6%96%87%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>在命令行编辑文件</h2>
<h3 id="nano">
<a class="anchor" href="#nano" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://www.nano-editor.org/docs.php">nano</a>
</h3>
<p>Nano 是一个简单易用的文本编辑器，使用 <code class="language-plaintext highlighter-rouge">nano</code> 命令运行：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nano intro_to_nano.txt
</code></pre></div></div>

<p>该命令会打开一个编辑窗口。常用操作包括：</p>
<ul>
  <li>Ctrl + o：将更改写入文件</li>
  <li>Ctrl + k：剪切当前行</li>
  <li>Ctrl + u：将剪切的内容粘贴到当前光标位置</li>
  <li>Ctrl + w：搜索</li>
  <li>Ctrl + x：退出</li>
</ul>

<h3 id="vi">
<a class="anchor" href="#vi" aria-hidden="true"><span class="octicon octicon-link"></span></a>vi</h3>
<p><em>vi</em> 是一个强大的文本编辑器，效率很高，学习成本也比较大。使用命令 <code class="language-plaintext highlighter-rouge">vi</code> 来编辑文件：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>vi intro_to_vi.txt
</code></pre></div></div>

<p>当文件编辑窗口打开后，使用 <code class="language-plaintext highlighter-rouge">i</code> 命令，启用编辑模式。</p>

<p>当编辑完成后，使用 <code class="language-plaintext highlighter-rouge">Esc</code> 键退出编辑模式，回到命令模式。在命令模式下，常用操作为：</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">dd</code> : 删除当前行</li>
  <li>
<code class="language-plaintext highlighter-rouge">yy</code> : 复制当前行</li>
  <li>
<code class="language-plaintext highlighter-rouge">p</code> : 粘贴已复制的内容</li>
  <li>
<code class="language-plaintext highlighter-rouge">x</code> : 删除当前光标处的字符</li>
  <li>
<code class="language-plaintext highlighter-rouge">:w</code> : 保存文件</li>
  <li>
<code class="language-plaintext highlighter-rouge">:q!</code> : 强制退出编辑并放弃保存</li>
  <li>
<code class="language-plaintext highlighter-rouge">:wq</code> : 保存文件并退出</li>
</ul>

<p>通过以下资料了解更多：</p>
<blockquote>

  <p>https://en.wikibooks.org/wiki/Learning_the_vi_Editor/vi_Reference</p>

  <p>https://www.debian.org/doc/manuals/debian-tutorial/ch-editor.html</p>
</blockquote>

<h2 id="文件对比">
<a class="anchor" href="#%E6%96%87%E4%BB%B6%E5%AF%B9%E6%AF%94" aria-hidden="true"><span class="octicon octicon-link"></span></a>文件对比</h2>
<h3 id="comm">
<a class="anchor" href="#comm" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://linux.die.net/man/1/comm">comm</a>
</h3>
<p><em>comm</em> 命令简单对比两文件，输出每行的对比结果。对比结果共三列，分辨代表近第一个文件中的行，两文件中同时存在的行，以及仅在第二个文件中的行。可通过 <code class="language-plaintext highlighter-rouge">-n</code> 选项，选择显示对比结果。效果如下：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>scan-a.txt
192.168.1.1
192.168.1.2
<span class="nv">$ </span><span class="nb">cat </span>scan-b.txt
192.168.1.1
192.168.1.3
192.168.1.4
192.168.1.5
192.168.1.6
<span class="nv">$ </span><span class="nb">comm </span>scan-a.txt scan-b.txt
		192.168.1.1
192.168.1.2
	192.168.1.3
	192.168.1.4
	192.168.1.5
	192.168.1.6
<span class="nv">$ </span><span class="nb">comm</span> <span class="nt">-1</span> scan-a.txt scan-b.txt <span class="c"># 仅显示 scan-b.txt 文件中的内容</span>
	192.168.1.1
192.168.1.3
192.168.1.4
192.168.1.5
192.168.1.6
<span class="nv">$ </span><span class="nb">comm</span> <span class="nt">-12</span> scan-a.txt scan-b.txt    <span class="c"># 显示两文件中同时存在的行</span>
192.168.1.1
</code></pre></div></div>

<h3 id="diff">
<a class="anchor" href="#diff" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://linux.die.net/man/1/diff">diff</a>
</h3>
<p><em>diff</em> 命令和 <em>comm</em> 命令差不多，但是支持更多输出选项。两个常用的选项是 <code class="language-plaintext highlighter-rouge">-c</code> 和 <code class="language-plaintext highlighter-rouge">-u</code>。</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>diff <span class="nt">-c</span> scan-a.txt scan-b.txt
<span class="k">***</span> scan-a.txt  2018-02-07 14:46:21.557861848 <span class="nt">-0700</span>
<span class="nt">---</span> scan-b.txt  2018-02-07 14:46:44.275002421 <span class="nt">-0700</span>
<span class="k">***************</span>
<span class="k">***</span> 1,5 <span class="k">****</span>
  192.168.1.1
- 192.168.1.2
  192.168.1.3
  192.168.1.4
  192.168.1.5
<span class="nt">---</span> 1,5 <span class="nt">----</span>
  192.168.1.1
  192.168.1.3
  192.168.1.4
  192.168.1.5
+ 192.168.1.6

<span class="nv">$ </span>diff <span class="nt">-u</span> scan-a.txt scan-b.txt
<span class="nt">---</span> scan-a.txt  2018-02-07 14:46:21.557861848 <span class="nt">-0700</span>
+++ scan-b.txt  2018-02-07 14:46:44.275002421 <span class="nt">-0700</span>
@@ <span class="nt">-1</span>,5 +1,5 @@
 192.168.1.1
<span class="nt">-192</span>.168.1.2
 192.168.1.3
 192.168.1.4
 192.168.1.5
+192.168.1.6
</code></pre></div></div>

<h3 id="vimdiff">
<a class="anchor" href="#vimdiff" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="http://www.vim.org/">vimdiff</a>
</h3>
<p><em>vimdiff</em> 通过 <em>vim</em> 打开多个文件，不同部分高亮显示。常用快捷键：</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">do</code> : 从其他窗口获取修改，应用到当前窗口</li>
  <li>
<code class="language-plaintext highlighter-rouge">dp</code> : 将当前窗口中的改变应用到另一个窗口</li>
  <li>
<code class="language-plaintext highlighter-rouge">]c</code> : 跳到下一处修改部分</li>
  <li>
<code class="language-plaintext highlighter-rouge">[c</code> : 跳到上一处</li>
  <li>
<code class="language-plaintext highlighter-rouge">Ctrl+w</code> : 切换到另一个窗口</li>
</ul>

<h2 id="管理进程">
<a class="anchor" href="#%E7%AE%A1%E7%90%86%E8%BF%9B%E7%A8%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>管理进程</h2>
<p>Linux 内核通过进程管理多任务。内核掌握每个进程的信息，每个进程拥有一个 PID（Process ID）。</p>

<p>Linux shell 引入 <em><a href="https://en.wikipedia.org/wiki/Job_control_(Unix)">jobs</a></em> 这个概念。比如，<code class="language-plaintext highlighter-rouge">cat error.txt | wc -m</code> 是一个拥有两个进程的管道命令，shell 将其视为一个 job。</p>
<h3 id="后台进程bg">
<a class="anchor" href="#%E5%90%8E%E5%8F%B0%E8%BF%9B%E7%A8%8Bbg" aria-hidden="true"><span class="octicon octicon-link"></span></a>后台进程（bg）</h3>
<p>之前的命令都是运行在前台的（foreground），这意味着在当前命令结束前，不能执行其他命令。我们可以将命令后台执行以便同时执行其他命令。</p>

<p>一个简单方法是在命令后添加 <code class="language-plaintext highlighter-rouge">&amp;</code> 符号，这表示在命令开始时将其送到后台。例如：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ping <span class="nt">-c</span> 400 localhost <span class="o">&gt;</span> ping_results.txt &amp;
<span class="o">[</span>1] 844
</code></pre></div></div>

<p>上面命令将给 localhost 发送 400 个 ICMP echo 包，将结果写入 <code class="language-plaintext highlighter-rouge">ping_results.txt</code>。该命令自动在后台执行。</p>

<p>如果执行命令时忘记添加 <code class="language-plaintext highlighter-rouge">&amp;</code> 将命令放在后台，可以通过 <code class="language-plaintext highlighter-rouge">Ctrl + c</code> 结束命令，添加后再执行。另一个方法是使用 <code class="language-plaintext highlighter-rouge">Ctrl + z</code> 暂停命令，然后使用 <code class="language-plaintext highlighter-rouge">bg</code> 命令将该进程放置到后台：</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ping -c 400 localhost &gt; ping_results.txt
^Z
[1]+  Stopped                 ping -c 400 localhost &gt; ping_results.txt
$ bg
[1]+ ping -c 400 localhost &gt; ping_results.txt &amp;
$
</code></pre></div></div>

<p>这时该任务就被放置到了后台执行。需要注意的是有些命令对时间敏感，如果暂停过长时间会导致输出结果异常。如上面的 <code class="language-plaintext highlighter-rouge">ping</code> 命令，如果在接收返回数据包时暂停了命令，<code class="language-plaintext highlighter-rouge">ping</code> 就会无法获取到返回包，导致结果不正确。</p>

<h3 id="任务管理jobs-和-fg-命令">
<a class="anchor" href="#%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86jobs-%E5%92%8C-fg-%E5%91%BD%E4%BB%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>任务管理：jobs 和 fg 命令</h3>
<p>使用 <code class="language-plaintext highlighter-rouge">jobs</code> 和 <code class="language-plaintext highlighter-rouge">fg</code> 命令可以快速检查 ICMP echo 的状态。</p>

<p><code class="language-plaintext highlighter-rouge">jobs</code> 命令可以列举出当前终端会话下运行着的任务，<code class="language-plaintext highlighter-rouge">fg</code> 命令可以将后台任务放置到前台。</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ping <span class="nt">-c</span> 400 localhost <span class="o">&gt;</span> ping_results.txt
^Z
<span class="o">[</span>1]+  Stopped                 ping <span class="nt">-c</span> 400 localhost <span class="o">&gt;</span> ping_results.txt
<span class="nv">$ </span>find / <span class="nt">-name</span> sbd.exe
^Z
<span class="o">[</span>2]+  Stopped                 find / <span class="nt">-name</span> sbd.exe
<span class="nv">$ </span><span class="nb">jobs</span>
<span class="o">[</span>1]-  Stopped                 ping <span class="nt">-c</span> 400 localhost <span class="o">&gt;</span> ping_results.txt
<span class="o">[</span>2]+  Stopped                 find / <span class="nt">-name</span> sbd.exe
<span class="nv">$ </span><span class="nb">fg</span> %1
ping <span class="nt">-c</span> 400 localhost <span class="o">&gt;</span> ping_results.txt
^C
<span class="nv">$ </span><span class="nb">jobs</span>
<span class="o">[</span>2]+  Stopped                 find / <span class="nt">-name</span> sbd.exe
<span class="nv">$ </span><span class="nb">fg
</span>find / <span class="nt">-name</span> sbd.exe
/usr/share/windows-resources/sbd/sbd.exe
...
</code></pre></div></div>

<p>在上面的命令中，<code class="language-plaintext highlighter-rouge">^C</code> 表示 <code class="language-plaintext highlighter-rouge">Ctrl + c</code>，用来终止当前进程。<code class="language-plaintext highlighter-rouge">fg</code> 命令后面的参数 <code class="language-plaintext highlighter-rouge">%1</code> 表示将任务编号为 1 的命令放到前台执行。有多种方式来表示后台任务，将一个后台任务放置到前台：</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">%n</code> : 指定任务编号，任务编号由 <code class="language-plaintext highlighter-rouge">jobs</code> 命令提供。比如 <code class="language-plaintext highlighter-rouge">%1</code> 或 <code class="language-plaintext highlighter-rouge">%2</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">%s</code> : 指定任务开头的命令，比如 <code class="language-plaintext highlighter-rouge">%ping</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">%+</code> 或 <code class="language-plaintext highlighter-rouge">%%</code> : 指当前任务</li>
  <li>
<code class="language-plaintext highlighter-rouge">%-</code> : 指上一个任务</li>
</ul>

<h3 id="任务管理ps-和-kill">
<a class="anchor" href="#%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86ps-%E5%92%8C-kill" aria-hidden="true"><span class="octicon octicon-link"></span></a>任务管理：ps 和 kill</h3>
<p><em><a href="http://www.linfo.org/ps.html">ps</a></em> 命令相比 <code class="language-plaintext highlighter-rouge">jobs</code> 命令更强大和使用。该命令不止列举出当前终端会话下的进程，而且列出系统进程等。（在 Windows PowerShell 中也存在 <code class="language-plaintext highlighter-rouge">ps</code> 命令，是 <code class="language-plaintext highlighter-rouge">Get-Process</code> 的别名）</p>

<p>在渗透测试中，访问主机后的一件事就是检查系统中运行着那些软件，这可以帮助我们评估当前权限、收集附加信息，为后续的操作做准备。</p>

<p>尝试打开 <em>Leafpad</em> 然后使用 <code class="language-plaintext highlighter-rouge">ps</code> 命令找到进程ID（<a href="https://en.wikipedia.org/wiki/Process_identifier">PID</a>）：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ps <span class="nt">-ef</span>
...
groot       869    829  1 00:05 pts/0    00:00:00 leafpad
www-data    973    506  0 00:05 ?        00:00:00 /usr/sbin/apache2 <span class="nt">-k</span> start
www-data    974    506  0 00:05 ?        00:00:00 /usr/sbin/apache2 <span class="nt">-k</span> start
groot      1069    829  0 00:05 pts/0    00:00:00 ps <span class="nt">-ef</span>
...
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">-ef</code> 选项表示：</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">-e</code> : 选出所有进程</li>
  <li>
<code class="language-plaintext highlighter-rouge">-f</code> : 显示全部列（UID, PID, PPID,等）</li>
</ul>

<p>在相当多的进程中找到我们的 <em>Leafpad</em> 程序有些复杂，这时可以将 <code class="language-plaintext highlighter-rouge">-e</code> 选项替换为 <code class="language-plaintext highlighter-rouge">-C</code> （通过命令名称选择）选项：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ps <span class="nt">-fC</span> leafpad
UID         PID   PPID  C STIME TTY          TIME CMD
groot       869    829  0 00:05 pts/0    00:00:00 leafpad
</code></pre></div></div>

<p>上面的结果返回了 <em>leafpad</em> 的 PID。通过查看手册了解 <code class="language-plaintext highlighter-rouge">ps</code> 命令的更多用法（<code class="language-plaintext highlighter-rouge">man ps</code>），会发现 <code class="language-plaintext highlighter-rouge">ps</code> 命令相当于进程管理的瑞士军刀。</p>

<p>如果要结束一个进程，可以通过 <code class="language-plaintext highlighter-rouge">kill</code> 命令后跟 PID 来实现。比如结束 <em>leafpad</em> 程序：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">kill </span>869

<span class="nv">$ </span>ps aux | <span class="nb">grep </span>leafpad
groot      1086  0.0  0.1  12780  1012 pts/0    S+   00:14   0:00 <span class="nb">grep </span>leafpad
</code></pre></div></div>

<p>这相当于 <code class="language-plaintext highlighter-rouge">kill</code> 命令给 <em>Leafpad</em> 发送了一个 <em>SIGTERM</em> （请求结束进程信号）。</p>

<h2 id="文件和命令监控">
<a class="anchor" href="#%E6%96%87%E4%BB%B6%E5%92%8C%E5%91%BD%E4%BB%A4%E7%9B%91%E6%8E%A7" aria-hidden="true"><span class="octicon octicon-link"></span></a>文件和命令监控</h2>
<p>对文件和命令进行实时监控在渗透测试中非常重要。<code class="language-plaintext highlighter-rouge">tail</code> 和 <code class="language-plaintext highlighter-rouge">watch</code> 是两个很有帮助的命令。</p>

<h3 id="tail">
<a class="anchor" href="#tail" aria-hidden="true"><span class="octicon octicon-link"></span></a>tail</h3>
<p>通常用 <em><a href="https://linux.die.net/man/1/tail">tail</a></em> 命令来监控日志文件。比如监控 Apache 日志：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo tail</span> <span class="nt">-f</span> /var/log/apache2/access.log
127.0.0.1 - - <span class="o">[</span>12/Oct/2020:01:50:39 <span class="nt">-0400</span><span class="o">]</span> <span class="s2">"GET / HTTP/1.1"</span> 200 3380 <span class="s2">"-"</span> <span class="s2">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15"</span>
127.0.0.1 - - <span class="o">[</span>12/Oct/2020:01:50:39 <span class="nt">-0400</span><span class="o">]</span> <span class="s2">"GET /icons/openlogo-75.png HTTP/1.1"</span> 200 6040 <span class="s2">"http://127.0.0.1/"</span> <span class="s2">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15"</span>
127.0.0.1 - - <span class="o">[</span>12/Oct/2020:01:50:39 <span class="nt">-0400</span><span class="o">]</span> <span class="s2">"GET /favicon.ico HTTP/1.1"</span> 404 492 <span class="s2">"http://127.0.0.1/"</span> <span class="s2">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15"</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">-f</code> 选项可以在目标文件更新时持续更新输出。<code class="language-plaintext highlighter-rouge">-nX</code> 选项可以输出指定行数（n），代替默认输出 10 行。</p>

<h3 id="watch">
<a class="anchor" href="#watch" aria-hidden="true"><span class="octicon octicon-link"></span></a>watch</h3>
<p><em><a href="https://linux.die.net/man/1/watch">watch</a></em> 命令可以用指定的时间间隔运行一个（已定义的）命令，默认间隔时间是 2s，可以通过 <code class="language-plaintext highlighter-rouge">-n X</code> 选项来自定义。比如列出登录用户（<code class="language-plaintext highlighter-rouge">w</code> 命令），每 5s 刷新：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>watch <span class="nt">-n</span> 5 w
Every 5.0s: w                                                           kali: Mon Oct 12 02:08:25 2020

 02:08:25 up 1 day,  2:50,  1 user,  load average: 0.00, 0.04, 0.01
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root    pts/0    :0    23:05    7.00s  3.17s  0.00s watch <span class="nt">-n</span> 5 w
</code></pre></div></div>

<p>使用 <code class="language-plaintext highlighter-rouge">Ctrl + c</code> 结束命令。</p>

<h2 id="下载文件">
<a class="anchor" href="#%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>下载文件</h2>
<p>从命令行下载文件到 Linux 系统中。</p>
<h3 id="wget">
<a class="anchor" href="#wget" aria-hidden="true"><span class="octicon octicon-link"></span></a>wget</h3>
<p><a href="https://www.gnu.org/software/wget/manual/wget.html">wget</a> 命令会经常用到，可以通过 HTTP/HTTPS 或 FTP 协议下载文件。使用选项 <code class="language-plaintext highlighter-rouge">-O</code> 将文件以指定的名称下载到指定位置：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>wget <span class="nt">-O</span> report_wget.pdf https://www.offensive-security.com/reports/penetration-testing-sample-report-2013.pdf
<span class="nt">--2020-10-12</span> 02:13:41--  https://www.offensive-security.com/reports/penetration-testing-sample-report-2013.pdf
Resolving www.offensive-security.com <span class="o">(</span>www.offensive-security.com<span class="o">)</span>... 192.124.249.5
Connecting to www.offensive-security.com <span class="o">(</span>www.offensive-security.com<span class="o">)</span>|192.124.249.5|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 27691955 <span class="o">(</span>26M<span class="o">)</span> <span class="o">[</span>application/pdf]
Saving to: ‘report_wget.pdf’

report_wget.pdf               100%[<span class="o">=================================================&gt;]</span>  26.41M  6.44MB/s    <span class="k">in </span>4.5s

2020-10-12 02:13:48 <span class="o">(</span>5.83 MB/s<span class="o">)</span> - ‘report_wget.pdf’ saved <span class="o">[</span>27691955/27691955]
</code></pre></div></div>

<h3 id="curl">
<a class="anchor" href="#curl" aria-hidden="true"><span class="octicon octicon-link"></span></a>curl</h3>
<p><a href="http://www.mit.edu/afs.new/sipb/user/ssen/src/curl-7.11.1/docs/curl.html">curl</a>  可以从服务器获取数据或将数据传输到服务端，该工具支持多种协议，包括 IMAP/S, POP3/S, SCP, SFTP, SMB/S, SMTP/S, TELNET, TFTP 等。在渗透测试中，使用该工具可以下载或上传文件，或者构造更复杂的请求。基本操作为：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-o</span> report.pdf https://www.offensive-security.com/reports/penetration-testing-sample-report-2013.pdf
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 26.4M  100 26.4M    0     0  3795k      0  0:00:07  0:00:07 <span class="nt">--</span>:--:-- 5679k
</code></pre></div></div>

<h3 id="axel">
<a class="anchor" href="#axel" aria-hidden="true"><span class="octicon octicon-link"></span></a>axel</h3>
<p><a href="http://manpages.ubuntu.com/manpages/xenial/man1/axel.1.html">axel</a> 是一个下载加速器，通过多连接将文件从 FTP/HTTP 服务器下载下来。该工具有很多特性，较常用的是 <code class="language-plaintext highlighter-rouge">-n</code> 选项，指定连接数。一个例子（<code class="language-plaintext highlighter-rouge">-a</code> 显示进度条；<code class="language-plaintext highlighter-rouge">-o</code> 指定保存文件名）：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>axel <span class="nt">-a</span> <span class="nt">-n</span> 20 <span class="nt">-o</span> report_axel.pdf https://www.offensive-security.com/reports/penetration-testing-sample-report-2013.pdf
Initializing download: https://www.offensive-security.com/reports/penetration-testing-sample-report-2013.pdf
File size: 27691955 bytes
Opening output file report_axel.pdf
Starting download

Connection 0 finished
Connection 1 finished
Connection 3 finished
Connection 4 finished
Connection 7 finished
Connection 2 finished
Connection 5 finished
Connection 6 finished
Connection 8 finished
Connection 9 finished
Connection 10 finished
Connection 12 finished
Connection 14 finished
Connection 17 finished
Connection 18 finished
Connection 13 finished
Connection 11 finished
Connection 15 finished
Connection 16 finished
Connection 19 unexpectedly closed

Downloaded 26.4091 Megabyte<span class="o">(</span>s<span class="o">)</span> <span class="k">in </span>2 second<span class="o">(</span>s<span class="o">)</span><span class="nb">.</span> <span class="o">(</span>12716.98 KB/s<span class="o">)</span>
</code></pre></div></div>

<h2 id="自定义-bash-环境">
<a class="anchor" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-bash-%E7%8E%AF%E5%A2%83" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义 Bash 环境</h2>
<h3 id="定制-bash-历史记录">
<a class="anchor" href="#%E5%AE%9A%E5%88%B6-bash-%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>定制 Bash 历史记录</h3>
<p>常用的三个自定义 <code class="language-plaintext highlighter-rouge">history</code> 命令操作和相关返回数据的环境变量是 <em>HISTCONTROL, HISTIGNORE, HISTTIMEFORMAT</em>。</p>

<p><em>HISTCONTROL</em> 参数定义了是否移除重复的命令，或者开头是空格的命令，默认是移除。调整该参数，使其只移除重复命令：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">HISTCONTROL</span><span class="o">=</span>ignoredups
</code></pre></div></div>

<p><em>HISTIGNORE</em> 参数可以定义为过滤常用命令比如 <code class="language-plaintext highlighter-rouge">ls, exit, history, bg</code> 等：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">HISTIGNORE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$:</span><span class="s2">ls:[bf]g:exit:history"</span>

<span class="nv">$ </span><span class="nb">mkdir test</span>

<span class="nv">$ </span><span class="nb">cd test</span>

<span class="nv">$ </span><span class="nb">ls</span>

<span class="nv">$ </span><span class="nb">pwd</span>
/home/kali/test
<span class="nv">$ </span><span class="nb">ls</span>

<span class="nv">$ </span><span class="nb">history
   </span>1  <span class="nb">export </span><span class="nv">HISTIGNORE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$:</span><span class="s2">ls:[bf]g:exit:history"</span>
   2  <span class="nb">mkdir test
   </span>3  <span class="nb">cd test
   </span>4  <span class="nb">pwd</span>
</code></pre></div></div>

<p><em>HISTTIMEFORMAT</em> 参数可以控制时间戳的显示：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">HISTTIMEFORMART</span><span class="o">=</span><span class="s1">'%F %T '</span>

<span class="nv">$ </span><span class="nb">history
   </span>1  2020-10-12 03:22:18 <span class="nb">export </span><span class="nv">HISTIGNORE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$:</span><span class="s2">ls:[bf]g:exit:history"</span>
   2  2020-10-12 03:22:25 <span class="nb">mkdir test
   </span>3  2020-10-12 03:22:26 <span class="nb">cd test
   </span>4  2020-10-12 03:22:29 <span class="nb">pwd</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">%F</code> 表示使用（ISO 8601 格式），<code class="language-plaintext highlighter-rouge">%T</code> 表示 24 小时制。更多格式可以参考 <em><a href="http://man7.org/linux/man-pages/man3/strftime.3.html">strftime</a></em>。</p>

<h3 id="别名alias">
<a class="anchor" href="#%E5%88%AB%E5%90%8Dalias" aria-hidden="true"><span class="octicon octicon-link"></span></a>别名（Alias）</h3>
<p>别名是一串可以代替常用命令和参数的字符串，使用别名可以使常用命令更简短。比如给常用的命令 <code class="language-plaintext highlighter-rouge">ls -la</code> 设置别名：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">alias </span><span class="nv">lsa</span><span class="o">=</span><span class="s1">'ls -la'</span>

<span class="nv">$ </span>lsa
total 8
drwxr-xr-x  2 kali kali 4096 Oct 12 03:22 <span class="nb">.</span>
drwxr-xr-x 15 kali kali 4096 Oct 12 03:22 ..
</code></pre></div></div>

<p>通过输入 <code class="language-plaintext highlighter-rouge">alias</code> 不带任何参数来查看已经设置了的别名：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">alias
alias </span><span class="nv">diff</span><span class="o">=</span><span class="s1">'diff --color=auto'</span>
<span class="nb">alias </span><span class="nv">egrep</span><span class="o">=</span><span class="s1">'egrep --color=auto'</span>
<span class="nb">alias </span><span class="nv">fgrep</span><span class="o">=</span><span class="s1">'fgrep --color=auto'</span>
<span class="nb">alias grep</span><span class="o">=</span><span class="s1">'grep --color=auto'</span>
<span class="nb">alias </span><span class="nv">ip</span><span class="o">=</span><span class="s1">'ip --color=auto'</span>
<span class="nb">alias </span><span class="nv">l</span><span class="o">=</span><span class="s1">'ls -CF'</span>
<span class="nb">alias </span><span class="nv">la</span><span class="o">=</span><span class="s1">'ls -A'</span>
<span class="nb">alias </span><span class="nv">ll</span><span class="o">=</span><span class="s1">'ls -l'</span>
<span class="nb">alias ls</span><span class="o">=</span><span class="s1">'ls --color=auto'</span>
</code></pre></div></div>

<p>设置别名时不检测已使用的关键字冲突问题，这意味着可以使用系统命令来当作其他命令的别名。比如：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">alias mkdir</span><span class="o">=</span><span class="s1">'ping -c 1 localhost'</span>

<span class="nv">$ </span><span class="nb">mkdir
</span>PING localhost<span class="o">(</span>localhost <span class="o">(</span>::1<span class="o">))</span> 56 data bytes
64 bytes from localhost <span class="o">(</span>::1<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.093 ms

<span class="nt">---</span> localhost ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 0.093/0.093/0.093/0.000 ms
</code></pre></div></div>

<p>如果不小心将已存在的命令设置为了别名，解决办法就是退出当前会话，或者使用 <code class="language-plaintext highlighter-rouge">unalias</code> 命令：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">unalias mkdir</span>

<span class="nv">$ </span><span class="nb">mkdir
mkdir</span>: missing operand
Try <span class="s1">'mkdir --help'</span> <span class="k">for </span>more information.
</code></pre></div></div>

<h3 id="持久化-bash-配置">
<a class="anchor" href="#%E6%8C%81%E4%B9%85%E5%8C%96-bash-%E9%85%8D%E7%BD%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>持久化 Bash 配置</h3>
<p>Bash 的系统配置在 <code class="language-plaintext highlighter-rouge">/etc/bash.bashrc</code>。每个用户都可以通过编辑用户根目录下的 <code class="language-plaintext highlighter-rouge">.bashrc 文件</code>（<code class="language-plaintext highlighter-rouge">~/.bashrc</code>）自定义自己的配置。</p>

<p><code class="language-plaintext highlighter-rouge">.bashrc</code> 文件在每次用户登录时执行，本质上是一个 shell 脚本，所以我们可以插入任何希望执行的命令。下面是 kali 默认的配置：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat</span> ~/.bashrc
<span class="c"># ~/.bashrc: executed by bash(1) for non-login shells.</span>
<span class="c"># see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)</span>
<span class="c"># for examples</span>

<span class="c"># If not running interactively, don't do anything</span>
<span class="k">case</span> <span class="nv">$-</span> <span class="k">in</span>
    <span class="k">*</span>i<span class="k">*</span><span class="p">)</span> <span class="p">;;</span>
      <span class="k">*</span><span class="p">)</span> <span class="k">return</span><span class="p">;;</span>
<span class="k">esac</span>
...
<span class="c"># for setting history length see HISTSIZE and HISTFILESIZE in bash(1)</span>
<span class="nv">HISTSIZE</span><span class="o">=</span>1000
<span class="nv">HISTFILESIZE</span><span class="o">=</span>2000
...
<span class="c"># enable color support of ls, less and man, and also add handy aliases</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-x</span> /usr/bin/dircolors <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">test</span> <span class="nt">-r</span> ~/.dircolors <span class="o">&amp;&amp;</span> <span class="nb">eval</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">dircolors</span> <span class="nt">-b</span> ~/.dircolors<span class="si">)</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">eval</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">dircolors</span> <span class="nt">-b</span><span class="si">)</span><span class="s2">"</span>
    <span class="nb">alias ls</span><span class="o">=</span><span class="s1">'ls --color=auto'</span>
    <span class="c">#alias dir='dir --color=auto'</span>
    <span class="c">#alias vdir='vdir --color=auto'</span>

    <span class="nb">alias grep</span><span class="o">=</span><span class="s1">'grep --color=auto'</span>
    <span class="nb">alias </span><span class="nv">fgrep</span><span class="o">=</span><span class="s1">'fgrep --color=auto'</span>
    <span class="nb">alias </span><span class="nv">egrep</span><span class="o">=</span><span class="s1">'egrep --color=auto'</span>
    <span class="nb">alias </span><span class="nv">diff</span><span class="o">=</span><span class="s1">'diff --color=auto'</span>
    <span class="nb">alias </span><span class="nv">ip</span><span class="o">=</span><span class="s1">'ip --color=auto'</span>

    <span class="nb">export </span><span class="nv">LESS_TERMCAP_mb</span><span class="o">=</span><span class="s1">$'</span><span class="se">\E</span><span class="s1">[1;31m'</span>     <span class="c"># begin blink</span>
    <span class="nb">export </span><span class="nv">LESS_TERMCAP_md</span><span class="o">=</span><span class="s1">$'</span><span class="se">\E</span><span class="s1">[1;36m'</span>     <span class="c"># begin bold</span>
    <span class="nb">export </span><span class="nv">LESS_TERMCAP_me</span><span class="o">=</span><span class="s1">$'</span><span class="se">\E</span><span class="s1">[0m'</span>        <span class="c"># reset bold/blink</span>
    <span class="nb">export </span><span class="nv">LESS_TERMCAP_so</span><span class="o">=</span><span class="s1">$'</span><span class="se">\E</span><span class="s1">[01;33m'</span>    <span class="c"># begin reverse video</span>
    <span class="nb">export </span><span class="nv">LESS_TERMCAP_se</span><span class="o">=</span><span class="s1">$'</span><span class="se">\E</span><span class="s1">[0m'</span>        <span class="c"># reset reverse video</span>
    <span class="nb">export </span><span class="nv">LESS_TERMCAP_us</span><span class="o">=</span><span class="s1">$'</span><span class="se">\E</span><span class="s1">[1;32m'</span>     <span class="c"># begin underline</span>
    <span class="nb">export </span><span class="nv">LESS_TERMCAP_ue</span><span class="o">=</span><span class="s1">$'</span><span class="se">\E</span><span class="s1">[0m'</span>        <span class="c"># reset underline</span>
<span class="k">fi</span>
</code></pre></div></div>

<p>从上面可以找到 <code class="language-plaintext highlighter-rouge">HISTSIZE</code> 和 <code class="language-plaintext highlighter-rouge">HISTFILESIZE</code> 环境变量以及 <code class="language-plaintext highlighter-rouge">alias</code> 别名配置。</p>
<br/><p>Comments:</p>

<script src="https://utteranc.es/client.js"
        repo="5cr1pt/commnets.blog.securitainment.io"
        issue-term="url"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>
<div><a href='https://blog.securitainment.io' style='text-align:center'>HOME</a>
</div>
<div style="display:none">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-137221448-1', 'auto');
    ga('send', 'pageview');

  </script>
</div>

        </div>
    </main>

    
    </body>
</html>
