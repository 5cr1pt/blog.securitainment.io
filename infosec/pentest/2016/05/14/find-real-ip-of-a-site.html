<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    
      查找網站真實IP
    
  </title>

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="查找網站真實IP" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="learn code hack" />
<meta property="og:description" content="learn code hack" />
<link rel="canonical" href="http://localhost:4000/infosec/pentest/2016/05/14/find-real-ip-of-a-site.html" />
<meta property="og:url" content="http://localhost:4000/infosec/pentest/2016/05/14/find-real-ip-of-a-site.html" />
<meta property="og:site_name" content="Securitainment.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-05-14T09:25:19+08:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/infosec/pentest/2016/05/14/find-real-ip-of-a-site.html"},"description":"learn code hack","headline":"查找網站真實IP","dateModified":"2016-05-14T09:25:19+08:00","datePublished":"2016-05-14T09:25:19+08:00","url":"http://localhost:4000/infosec/pentest/2016/05/14/find-real-ip-of-a-site.html","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Securitainment.io" />

  <link rel="shortcut icon" type="image/x-icon" href="/" />
  <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" />
</head>
<body>
    <main class="page-content" aria-label="Content">
        <div class="wrapper">
            <a href="http://localhost:4000"></a>
<h1>查找網站真實IP</h1>
<!--more-->

<h2 id="查找cdn负载均衡反向代理等大型网络真实ip地址的方法">查找“CDN、负载均衡、反向代理”等大型网络真实IP地址的方法</h2>

<p><strong>首先，CDN、负载均衡、反向代理还分为很多层，有时查出来的是最外层的 CDN 服务器群，真实的机器是不对外开放的，类似这样的：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>用户　　→　　　CDN 网络　　　→　　一台或多台真实机器

　　　　↗　　CDN Server 1　　↘
用户　　→　　CDN Server 2　　→　　真实机器
　　　　↘　　CDN Server N　　↗

--------------------------------------------------------

用户　　→　　　CDN 网络　　　→　　一台或多台反向代理　　　→　　一台或多台真实机器

　　　　↗　　CDN Server 1　　↘
用户　　→　　CDN Server 2　　→　　Reverse Proxy Server　　→　　真实机器
　　　　↘　　CDN Server N　　↗
</code></pre></div></div>

<p>具体根据网络的负载需求，CDN 服务器的数量以及分级层数是不一定的。</p>

<p>如果是这样的话，除非日一台CDN服务器看记录或者日进CDN供应商控制系统或后台，才能找到真实IP，但是那些CDN服务器配置完全一样，应该很难搞。</p>

<p>（这些CDN服务器不止代理的这一家网站，现在都是同时代理很多家网站，这就可以解释你旁站查询出来很多不相干的网站都在同一个IP地址，这是CDN服务器供应商节省成本的一种方案，一台CDN同时代理多家网站，CDN供应商根据你支付金额的多少，决定使用多少台CDN服务器。）</p>

<p>（这些CDN服务器一般都在高防机房，拥有很大的带宽，并且大多数CDN运营商还拥有云防火墙技术，什么叫云防火墙？即：任意一台服务器检测到DDOS攻击后，会向所有服务器通告这些攻击源IP，然后所有这些服务器都同时屏蔽这些地址，以实现整个网络屏蔽DDOS的目的，这些服务器组成了一个很强力的抗DDOS网络，这是目前对付DDOS攻击，比较有效的方案之一。）</p>

<p>（再补充一点经验，这些CDN服务器还根据你提交的 HTTP HOST 头（也就是域名）返回不一样的系统信息，更有甚者，只要你 HTTP HOST 头不正确（不是它提供服务的域名），直接掐断连接，不返回任何数据，你就得不到任何有效信息，如果你使用“<a href="http://lcx.cc/?FoxNews=1904.html">长安刺客 - 旁注杀手 v1.2 版 + CDN 终结者 v1.1</a>”的话，那么需要在 CDN 终结者界面勾选特殊模式，然后再刺探网络构架，有时候会有惊喜哟……）</p>

<p><strong>还有另外一种：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>用户　　→　　多台实时同步的缓存服务器与真实机器

　　　　↗　　Cache Server 1
用户　　→　　Cache Server 2
　　　　↘　　Cache Server N
　　　　↘　　真实机器
</code></pre></div></div>

<p>如果是这种的话，很容易就可以找出来真实服务器的IP地址，因为他们 HTTP Banner 等信息是完全不一样的，用“长安刺客 - 旁注杀手”一眼就看出来了。</p>

<p><strong>还有另外几种 CDN、负载均衡、反向代理 等网络构架：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>用户　　→　　　负载均衡　　　→　　服务器群

　　　　　　　　　　　　　　　↗　　Cache Server 1
用户　　→　　Load Balance　　→　　Cache Server 2
　　　　　　　　　　　　　　　↘　　Cache Server N

--------------------------------------------------------------

用户　　→　　　反向代理类服务器　　　→　　一台或多台真实机器

　　　　　　　　　　　　　　　　　　　↗　　真实机器1
用户　　→　　Reverse Proxy Server　　→　　真实机器2
　　　　　　　　　　　　　　　　　　　↘　　真实机器N
</code></pre></div></div>

<p>再结合 xxbing 提供的方法：</p>

<p><strong>关于探测主站真实IP，我一般先查一下分站IP，有一种情况是，主站采用了CDN，分站没有用。</strong></p>

<p>比如 bbs.xxx.com、vip.xxx.com、pay.xxx.com 都是 111.111.111.x 段的，那么主站也很有可能是 111.111.111.x 段的。扫一下这个段的80吧。</p>

<p>这确实是个好方法，针对国内的大站，多分玉米的很实用。但是现在很多国外站各种分域名ping出来和主站都是一个IP。</p>

<p>可以暴力跑一下2级域名。什么 blog.xxx.com、admin.xxx.com、root.xxx.com。反正4位英文以内的。。</p>

<p><strong>二级域名 nslookup 百度，谷歌 搜集信息</strong></p>

<p><strong>还听说有国外vpn ping的方式</strong></p>

<blockquote>
  <p>使用国外 vpn ping 的方法是因为，大部分CDN提供商只针对国内市场，而对国外市场几乎是不做CDN，所以有很大的几率会直接解析到真实IP。其实这个方法根本不用上国外vpn，因为你上国外vpn的ping本质，就是使用国外dns（那台vpn服务器使用的dns）查询域名而已，所以只需要：nslookup lcx.cc 国外dns，就行了，例如：nslookup lcx.cc 8.8.8.8，提示：你要找冷门国外DNS才行，像谷歌的DNS，国内用的人越来越多了，很多CDN提供商都把谷歌DNS作为国内市场之一，所以，你查到的结果会和国内差不了多少……</p>
</blockquote>

<p>1 历史记录(<a href="http://toolbar.netcraft.com/site_report?url=www.xxx.net">http://toolbar.netcraft.com/site_report?url=www.xxx.net</a>)</p>

<p>2 phpinfo</p>

<p>3 经常用ping xxx.com代替ping www.xxx.com,然后ping子域,再nslookup</p>

<p><strong>有的服务器本地自带sendmail…  注册之后，会主动发一封邮件给我们。。。 好吧。。打开邮件的源代码。。 你就能看到服务器的真实Ip了。。。有的大型互联网网站会有自己的Mailserver…应该也是处在一个网段吧？？  那个网段打开80的一个一个试。。。哈哈。。</strong></p>
<br/><p>Comments:</p>

<script src="https://utteranc.es/client.js"
        repo="5cr1pt/commnets.blog.securitainment.io"
        issue-term="url"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>

<div style="display:none">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-137221448-1', 'auto');
    ga('send', 'pageview');

  </script>
</div>

        </div>
    </main>

    
    </body>
</html>
