<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
     <link rel="shortcut icon" href= //images/favicon.ico >
    <title>
        Securitainment.io
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>
<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-home
 replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            MS07-040 .NET Framework中的漏洞可能允许远程执行代码
        </p>
        <hr>
    </div>
    <div class="post-content">
        <a id="more"></a>


<h1 id="MS07-040"><a href="#MS07-040" class="headerlink" title="MS07-040"></a><a href="https://technet.microsoft.com/library/security/ms07-040" target="_blank" rel="noopener">MS07-040</a></h1><p><em>Microsoft .Net Framework多个空字节注入漏洞</em></p>
<h2 id="受影响系统"><a href="#受影响系统" class="headerlink" title="受影响系统"></a>受影响系统</h2><pre><code>Microsoft .NET Framework 2.0
Microsoft .NET Framework 1.1
Microsoft .NET Framework 1.0</code></pre><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>BUGTRAQ  ID: <a href="http://www.securityfocus.com/bid/24791" target="_blank" rel="noopener">24791</a></p>
<p>CVE(CAN) ID: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0042" target="_blank" rel="noopener">CVE-2007-0042</a></p>
<p>Microsoft .NET Framework是一个流行的软件开发工具包。 </p>
<p>.NET Framework在处理网页请求时存在漏洞，远程攻击可能利用此漏洞绕过安全限制访问到敏感信息。</p>
<p>.NET Framework的Server.MapPath、Server.Execute、Server.Transfer、String.Compare、System.Net.Mail.SmtpMail.Send方式没有正确地验证某些用户输入参数，允许用户在提交的URI中注入任意空字节。成功地利用此漏洞的攻击者绕过ASP.NET网站的安全限制下载任何网页的内容。</p>
<blockquote>
<p>来源：Paul Craig （<a href="mailto:headpimp@pimp-industries.com">headpimp@pimp-industries.com</a>）</p>
</blockquote>
<blockquote>
<p>链接：<a href="http://security-assessment.com/files/advisories/2007-07-11_Multiple_.NET_Null_Byte_Injection_Vulnera" target="_blank" rel="noopener">http://security-assessment.com/files/advisories/2007-07-11_Multiple_.NET_Null_Byte_Injection_Vulnera</a><br><a href="http://secunia.com/advisories/26003/" target="_blank" rel="noopener">http://secunia.com/advisories/26003/</a><br><a href="http://www.microsoft.com/technet/security/Bulletin/ms07-040.mspx?pf=true" target="_blank" rel="noopener">http://www.microsoft.com/technet/security/Bulletin/ms07-040.mspx?pf=true</a><br><a href="http://www.us-cert.gov/cas/techalerts/TA07-191A.html" target="_blank" rel="noopener">http://www.us-cert.gov/cas/techalerts/TA07-191A.html</a></p>
</blockquote>
<h2 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h2><ul>
<li><p>例1：</p>
  <figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=<span class="string">"vb"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">   &lt;head&gt;</span><br><span class="line">      &lt;title&gt;vb.net MapPath example &lt;/title&gt;</span><br><span class="line">      &lt;script runat=<span class="string">"server"</span>&gt;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">Sub</span> Page_Load()</span><br><span class="line">              <span class="keyword">dim</span> name <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line">              <span class="keyword">dim</span> realname <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line">          name = request(<span class="string">"name"</span>) &amp; <span class="string">".uploaded"</span></span><br><span class="line">              realname = Mappath(<span class="string">"."</span>) &amp; <span class="string">"\"</span> &amp; name</span><br><span class="line">          response.write(<span class="string">"Mappath of name = &lt;b&gt;"</span> &amp; MapPath(name) &amp; <span class="string">"&lt;/b&gt;&lt;br&gt;"</span>)</span><br><span class="line">               response.write(<span class="string">"The real value is: &lt;b&gt;"</span> &amp; realname &amp; <span class="string">"&lt;/b&gt;&lt;br&gt;"</span>)</span><br><span class="line">         <span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">      &lt;/script&gt;</span><br><span class="line">   &lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">   &lt;asp:label id=<span class="string">"Message"</span> runat=<span class="string">"server"</span>/&gt;</span><br><span class="line">   &lt;asp:label id=<span class="string">"Message2"</span> runat=<span class="string">"server"</span>/&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>例2：</p>
  <figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=<span class="string">"VB"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">  			&lt;script runat=<span class="string">"server"</span>&gt;</span><br><span class="line">     			<span class="keyword">Sub</span> Page_Load()</span><br><span class="line">        		Server.Execute(request(<span class="string">"page"</span>))</span><br><span class="line">      		<span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">  			&lt;/script&gt;</span><br><span class="line">	&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>例3：</p>
  <figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=<span class="string">"VB"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Server.execute &lt;/title&gt;</span><br><span class="line">   &lt;script runat=<span class="string">"server"</span>&gt;</span><br><span class="line">      <span class="keyword">Sub</span> Page_Load()</span><br><span class="line">      Server.Transfer(request(<span class="string">"page"</span>))</span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>例4：</p>
  <figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=<span class="string">"vb"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">   &lt;head&gt;</span><br><span class="line">      &lt;title&gt;<span class="built_in">String</span>.<span class="keyword">Compare</span>&lt;/title&gt;</span><br><span class="line">      &lt;script runat=<span class="string">"server"</span>&gt;</span><br><span class="line">         <span class="keyword">Sub</span> Page_Load()</span><br><span class="line">			<span class="keyword">dim</span> allowed, sFirstItem, sSecondItem <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line">		    sFirstItem = Request(<span class="string">"first"</span>)</span><br><span class="line">		    sSecondItem = Request(<span class="string">"second"</span>)</span><br><span class="line">		    response.Write (<span class="string">"String.Compare - First item = "</span> &amp; sFirstItem &amp; <span class="string">"&lt;br&gt;"</span>)</span><br><span class="line">		    response.Write (<span class="string">"String.Compare - Second item = "</span> &amp; sSecondItem &amp; <span class="string">"&lt;br&gt;"</span>)</span><br><span class="line">		    <span class="keyword">if</span> <span class="built_in">String</span>.<span class="keyword">Compare</span>(sFirstItem, sSecondItem) =<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">		        response.Write (<span class="string">"&lt;b&gt;String.Compare - Matched! Strings are the same&lt;/b&gt;"</span> &amp; <span class="string">"&lt;br&gt;"</span>)    </span><br><span class="line">		    <span class="keyword">else</span></span><br><span class="line">		        response.Write (<span class="string">"&lt;b&gt;String.Compare - Failed!! Strings are diffrent &lt;/b&gt;"</span> &amp; <span class="string">"&lt;br&gt;"</span>)</span><br><span class="line">		    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">		    <span class="keyword">if</span> sFirstItem=sSecondItem <span class="keyword">then</span></span><br><span class="line">		        response.Write (<span class="string">"Direct eval - Matched!"</span> &amp; <span class="string">"&lt;br&gt;"</span>)</span><br><span class="line">		        <span class="keyword">else</span></span><br><span class="line">		        response.Write (<span class="string">"&lt;b&gt;Direct eval - Failed!!&lt;/b&gt;"</span> &amp; <span class="string">"&lt;br&gt;"</span>)</span><br><span class="line">		    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">         <span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">      &lt;/script&gt;</span><br><span class="line">   &lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>例5：</p>
  <figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;% @Import <span class="keyword">Namespace</span>=<span class="string">"System.Web.Mail"</span> %&gt;</span><br><span class="line">&lt;% @Import <span class="keyword">Namespace</span>=<span class="string">"System.IO"</span> %&gt;</span><br><span class="line">&lt;%@ Page Language=<span class="string">"vb"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">   &lt;head&gt;</span><br><span class="line">      &lt;title&gt;vb.net MapPath example &lt;/title&gt;</span><br><span class="line">      &lt;script runat=<span class="string">"server"</span>&gt;</span><br><span class="line">		<span class="keyword">Private</span> <span class="keyword">Sub</span> Page_Load(sender <span class="keyword">As</span> <span class="built_in">Object</span>, e <span class="keyword">As</span> System.EventArgs)</span><br><span class="line">		<span class="keyword">Dim</span> m <span class="keyword">As</span> <span class="keyword">New</span> MailMessage()</span><br><span class="line">		m.<span class="keyword">From</span> = <span class="string">"tester@security-assessment.com"</span></span><br><span class="line">		m.<span class="keyword">To</span> = request(<span class="string">"to"</span>) &amp; <span class="string">"@security-assessment.com"</span></span><br><span class="line">		m.Subject = request(<span class="string">"subject"</span>) &amp; <span class="string">": FromWebsite"</span></span><br><span class="line">		m.Body = request(<span class="string">"body"</span>) &amp; <span class="string">"This message was submitted by a user."</span></span><br><span class="line">		Response.Write(<span class="string">"Sending mail to: "</span> &amp; m.<span class="keyword">to</span>)</span><br><span class="line">		m.Fields.Add(<span class="string">"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate"</span>, <span class="string">"1"</span>) <span class="comment">'basic authentication</span></span><br><span class="line">		m.Fields.Add(<span class="string">"http://schemas.microsoft.com/cdo/configuration/sendusername"</span>, <span class="string">"username-goes-here"</span>) </span><br><span class="line">		m.Fields.Add(<span class="string">"http://schemas.microsoft.com/cdo/configuration/sendpassword"</span>, <span class="string">"password-goes-here"</span>) <span class="comment">'set your </span></span><br><span class="line">		SmtpMail.SmtpServer = <span class="string">"mail.server.here"</span></span><br><span class="line">		SmtpMail.Send(m)</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">      &lt;/script&gt;</span><br><span class="line">   &lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ul>

    </div>

    
</div>
    <div class="footer" id="footer">
    <p><h4>Copyright © 2020 | Author: Groot | <a href="https://github.com/Xunzhuo/hexo-theme-coder" target="_blank" rel="noopener">Theme: Hexo-Coder</a></h4>
        <label class="el-switch el-switch-blue el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="">
<input type="hidden" id="valine_appKey" value="">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>
</html>